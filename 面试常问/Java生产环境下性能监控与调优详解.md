# 基于JDK命令行工具的监控（不会就看文档，官网最权威！）

![image-20220326225049951](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225049951.png)

![image-20220326225123362](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225123362.png)

![image-20220326225136082](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225136082.png)

![image-20220326225146729](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225146729.png)

![image-20220326225305232](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225305232.png)

![image-20220326225414165](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225414165.png)

![image-20220326225600341](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225600341.png)

![image-20220326225702803](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225702803.png)

![image-20220326225725667](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225725667.png)

 ![image-20220326225819242](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225819242.png)

![image-20220326225934218](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326225934218.png)

![image-20220326230142878](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326230142878.png)

![image-20220326230459274](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220326230459274.png)

![image-20220328082353902](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328082353902.png)

![image-20220328082431971](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328082431971.png)

![image-20220328082546083](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328082546083.png)

![image-20220328084451169](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328084451169.png)

![image-20220328084653721](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328084653721.png)

![image-20220328104253241](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104253241.png)

![image-20220328104319791](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104319791.png)

![image-20220328104412421](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104412421.png)![image-20220328104608596](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104608596.png)

![image-20220328104446708](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104446708.png)

jinfo:已经正在运行的jvm的参数值

![image-20220328104746576](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104746576.png)

![image-20220328104943179](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328104943179.png)

![image-20220328105050387](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328105050387.png)

![image-20220328224300875](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328224300875.png)

![image-20220328224424264](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328224424264.png)

![image-20220328224702309](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328224702309.png)

![image-20220328224803921](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328224803921.png)

![image-20220328225045278](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328225045278.png)

![image-20220328225155763](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328225155763.png)

![image-20220328225240999](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328225240999.png)

![image-20220328225725075](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328225725075.png)

![image-20220328230226610](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328230226610.png)

![image-20220328230255859](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220328230255859.png)

Metaspace:操作系统的本地内存，独立于堆区之外

CCS:压缩类空间

## 堆内存溢出：

![image-20220407094254910](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094254910.png)

![image-20220407094324662](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094324662.png)

![image-20220407094339057](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094339057.png)

## 非堆溢出（Class、Field、Method）：

![image-20220407094718540](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094718540.png)

## asm:动态生成Class

![image-20220407094802770](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094802770.png)

![image-20220407094842538](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094842538.png)

![image-20220407094953661](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407094953661.png)

![image-20220407095030807](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407095030807.png)

# 如何导出内存映像文件：

![image-20220407095338502](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407095338502.png)

![image-20220407104304979](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104304979.png)

![image-20220407104350522](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104350522.png)

![image-20220407104417590](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104417590.png)

![image-20220407104442219](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104442219.png)

![image-20220407104517596](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104517596.png)

![image-20220407104607159](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104607159.png)

![image-20220407104728085](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104728085.png)

![image-20220407104746905](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407104746905.png)

# MAT分析内存溢出：IDEA没有

![image-20220407105505901](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407105505901.png)

# jstack与线程的状态：

![image-20220407105957167](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407105957167.png)

![image-20220407110009511](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110009511.png)

![image-20220407110158012](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110158012.png)

![image-20220407110252489](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110252489.png)

![image-20220407110548851](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110548851.png)

![image-20220407110715498](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110715498.png)

![image-20220407110745253](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110745253.png)

![image-20220407110818950](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110818950.png)

![image-20220407110840025](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407110840025.png)

![image-20220407111914717](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407111914717.png)

# 实战死循环导致CPU飙高：

![image-20220407111939786](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407111939786.png)

![image-20220407112058000](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407112058000.png)

![image-20220407112423996](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407112423996.png)

![image-20220407112644547](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407112644547.png)

top，注意左上角有Tasks，所以PID是进程

![image-20220407112842057](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407112842057.png)



![image-20220407112931208](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407112931208.png)

![image-20220407113002867](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113002867.png)

![image-20220407113202514](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113202514.png)

![image-20220407113306783](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113306783.png)

![image-20220407113329388](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113329388.png)

![image-20220407113358722](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113358722.png)

![image-20220407113445138](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113445138.png)

![image-20220407113541973](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113541973.png)

综上，CPU飙高的问题找到了，是这个方法！

# 死锁：

![image-20220407113947859](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407113947859.png)

![image-20220407114019616](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407114019616.png)

![image-20220407114134205](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407114134205.png)

![image-20220407114324843](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407114324843.png)

# jVisualVM:

![image-20220407120309982](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407120309982.png)![image-20220407120636505](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407120636505.png)

![image-20220407120429013](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407120429013.png)

![image-20220407120931248](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407120931248.png)

![image-20220407121024836](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121024836.png)

![image-20220407121127947](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121127947.png)

![image-20220407121156865](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121156865.png)

![image-20220407121317194](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121317194.png)

![image-20220407121507854](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121507854.png)

# Btrace:

![image-20220407121903981](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121903981.png)

![image-20220407121942953](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407121942953.png)

![image-20220407151148432](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407151148432.png)

![image-20220407151428854](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407151428854.png)

![image-20220407152941832](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407152941832.png)

![image-20220407153041134](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407153041134.png)

![image-20220407153113934](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407153113934.png)

![image-20220407153512365](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407153512365.png)

![image-20220407154047052](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407154047052.png)

![image-20220407154133250](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407154133250.png)

![image-20220407154710574](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407154710574.png)

![image-20220407155325700](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407155325700.png)

# ![image-20220407155611280](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220407155611280.png)5-1 tomcat远程debug![image-20220409182754957](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409182754957.png)

![image-20220409182912607](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409182912607.png)

![image-20220409183030923](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409183030923.png)

![image-20220409183056964](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409183056964.png)

![image-20220409183403283](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409183403283.png)

![image-20220409183442309](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409183442309.png)

![image-20220409184911903](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409184911903.png)

![image-20220409185023153](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409185023153.png)

![image-20220409185100330](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409185100330.png)

![image-20220409185217886](C:\Users\kgliu\AppData\Roaming\Typora\typora-user-images\image-20220409185217886.png)

